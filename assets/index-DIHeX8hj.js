import{j as e,x as j,f as F,r as n,as as M,w as P,ai as L,cf as R,L as k,v as E,b5 as S,b1 as u,aO as C,B as U}from"./index-W2AL0DnC.js";const V=({products:s})=>e.jsx(e.Fragment,{children:e.jsxs("table",{className:"table-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"border-r border-white-600 px-4 py-2",children:e.jsx("div",{className:"w-20",children:e.jsx(j,{store:s[0].store})})}),e.jsx("th",{className:"px-4 py-2",children:e.jsx("div",{className:"w-20",children:e.jsx(j,{store:s[1].store})})})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/2 border-b border-r border-white-600 px-4 py-2",children:e.jsx("img",{src:s[0].image,alt:s[0].name,className:"h-16 "})}),e.jsx("td",{className:"w-1/2 border-b border-white-600 px-4 py-2",children:e.jsx("img",{src:s[1].image,alt:s[1].name,className:"h-16"})})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/2 border-b border-r border-white-600 px-4 py-2 text-base",children:s[0].name}),e.jsx("td",{className:"w-1/2 border-b border-white-600  px-4 py-2 text-base",children:s[1].name})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"w-1/2  border-r border-white-600 px-4 py-2 text-xl font-bold",children:s[0].price}),e.jsx("td",{className:"w-1/2  px-4 py-2",children:e.jsxs("div",{className:"flex-start flex text-xl",children:[e.jsx("div",{className:"font-bold ",children:s[1].price}),s[1].discountPrice&&e.jsx("div",{className:"ml-1 self-center rounded-full px-1 text-sm text-red-800 line-through",children:s[1].discountPrice})]})})]})]})]})}),B=({product:s,originalStore:i,destinationStore:c,closeDialog:o,itemReplacement:I})=>{var w;const b=F("(max-width: 639px)"),[d,m]=n.useState(),{isFetching:l,refetch:p}=M(`${s.productId}`,[c]),[x,f]=n.useState(),[t,h]=n.useState(null);n.useEffect(()=>(h(null),p().then(r=>{h(r.data)}).catch(()=>{}),()=>{h(null)}),[s.productId,c,o,p]);const g=(r,a,T)=>{var v,y;f([{id:r.productId,name:r.productName,image:r.productThumbnailUri,price:(v=r.unitPrice)==null?void 0:v.displayValue,store:T},{id:a.id,name:a.name,image:a.images.thumbnail.uri,price:(y=a.sellingPrice)==null?void 0:y.displayValue.split(" ")[0],store:a.storeName,discountPrice:a.isDiscounted?a.retailPrice.displayValue.split(" ")[0]:""}])},N=e.jsxs("div",{className:"flex flex-row justify-start px-5 py-2  sm:px-1",children:[e.jsx("img",{src:s.productThumbnailUri,alt:"Product",className:" mr-8 h-28 w-20 rounded-md object-contain"}),e.jsxs("div",{className:"flex flex-col sm:justify-center",children:[e.jsx("div",{className:"mb-1 w-20",children:e.jsx(j,{store:i})}),e.jsx("h4",{className:"mb-1  cursor-pointer text-base",title:P(s.productName??""),children:P(s.productName??"")}),e.jsx("h3",{className:"flex text-lg font-bold text-purple-500 sm:text-sm",children:(w=s.unitPrice)==null?void 0:w.displayValue.split(" ")[0]})]})]});return e.jsx(L,{onClose:o,showCloseBtn:!0,modalWidth:b?"100%":"66%",shouldShow:!0,isFilterModal:!!b,shouldClose:!0,titleBgColor:"bg-purple-500",title:"Find exact or similar products",children:e.jsx("div",{className:"relative  flex flex-col",children:e.jsxs(e.Fragment,{children:[d&&x&&e.jsxs("div",{className:"left-0 mb-4 flex cursor-pointer items-center gap-1 text-sm hover:underline",onClick:()=>{m(void 0),f(void 0)},children:[e.jsx(R,{})," Back to exact or similar products list"]}),s.productId?e.jsx(k,{to:E.product_detail(encodeURIComponent(s.productId)),children:N}):N,l&&e.jsx(e.Fragment,{children:e.jsx(S,{isLoading:l,label:"Fetching similar products"})}),!l&&(t==null?void 0:t.data.similarProducts.length)===0&&(t==null?void 0:t.data.exactMatches.length)===0&&e.jsxs("div",{className:"py-4 text-center text-base font-semibold",children:["No matches found at ",u(c)]}),!l&&t&&!d&&e.jsxs("div",{className:"py-10",children:[t.data.exactMatches.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xl font-semibold",children:"Exact matches"}),e.jsx(C,{products:t.data.exactMatches||[],scrollable:!0,layout:"grid",replaceProductInUrl:!0,similarItemDialog:!0,switchProductTriggered:r=>{m(r),g(s,r,i)}})]}),t.data.similarProducts.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-xl font-semibold",children:"Similar products"}),l,e.jsx(C,{products:(t==null?void 0:t.data.similarProducts)||[],scrollable:!0,layout:"grid",replaceProductInUrl:!0,similarItemDialog:!0,switchProductTriggered:r=>{m(r),g(s,r,i)}})]})]}),d&&x&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"py-4 text-center font-semibold",children:["Replace item from ",u(i)," with an item from ",u(c)]}),e.jsx(V,{products:x}),e.jsx("div",{className:"m-auto mt-8 w-40 md:w-full sm:w-full",children:e.jsx(U,{variant:"filled",colorTheme:"green",onClick:()=>{I(d.id),o()},children:"Replace"})})]})]})})})};export{B as S};
