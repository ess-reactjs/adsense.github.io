import{af as le,r as I,f as te,j as e,e as S,ag as ne,ah as ie,bP as oe,ai as ce,B as de,c6 as k,c7 as U,au as ue,av as me,c8 as $,b0 as pe,c5 as F,l as xe,q as ge,c2 as he,V as ee,a_ as fe,aM as be,c3 as we,D as Q,o as se,t as Z}from"./index-W2AL0DnC.js";import{u as Ae,a as je}from"./MembershipAPI-D2n6KU8D.js";import{B as J}from"./index-S1YyA5q5.js";const Ne="_radio_vuote_1",ve={radio:Ne},ye=({title:g,content:l,titleStyle:b,id:i,isRadioButton:E,onRadioChange:P,isChecked:O,targetCart:z,style:y,isEnlargeable:R,defaultExpanded:X=!1})=>{const{over:A}=le({id:i}),[K,T]=I.useState(!1),[u,V]=I.useState(X),L=te("(max-width: 639px)");I.useEffect(()=>{A&&V(()=>A!=null&&A.id?(A==null?void 0:A.id)===i||z===i:!1)},[A,A==null?void 0:A.id,z,i]);const W=()=>{V(n=>!n)},Y=()=>{s(),V(!0),T(!1)},s=()=>{E&&P(i)};return e.jsxs("div",{className:"accordion",children:[e.jsxs("div",{className:S("accordion-header relative flex cursor-pointer items-center justify-between p-5 py-6 transition-all	duration-75 sm:p-3",{" bg-purple-500 text-white-100":y=="purple"&&u,"rounded-lg bg-white-100 text-purple-500 ":y=="purple"&&!u}),onClick:W,children:[E&&e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{onClick:n=>{n.stopPropagation()},className:S(ve.radio,"inline-block"),children:[e.jsx("input",{className:"hover:cursor-pointer",name:"radio",type:"radio",id:i==null?void 0:i.toString(),hidden:!0,value:i,onChange:n=>{n.stopPropagation(),s()},checked:O}),e.jsx("label",{htmlFor:i==null?void 0:i.toString(),className:"mr-5 flex h-5 w-5 items-center justify-center rounded-full px-2 py-1 text-xl font-bold transition-all hover:cursor-pointer"})]}),e.jsx("div",{className:b,children:g})]}),!E&&g,e.jsxs("div",{className:"flex",children:[u?e.jsx(ne,{className:S("ml-3 h-5 w-5 ",{"text-white-100":y=="purple"&&u,"text-white-700":y!="purple"})}):e.jsx(ie,{className:S("ml-3 h-5 w-5 ",{"text-white-100":y=="purple","text-white-700":y!="purple"||y=="purple"&&!u})}),R&&e.jsx("div",{className:"self-center pl-4",onClick:n=>{n.stopPropagation(),n.preventDefault(),T(!0)},children:e.jsx(oe,{size:15,className:S("self-center opacity-80",{"text-white-700":y=="purple"&&!u})})})]})]}),u&&e.jsx("div",{className:S("accordion-body membersip__accordion relative rounded-b-lg border-t p-5 sm:p-3",{"bg-purple-100":y=="purple"}),style:{borderColor:"#D9D9D9"},children:l}),e.jsx(e.Fragment,{children:K&&e.jsxs(ce,{onClose:()=>{T(!1)},modalWidth:L?"100%":"60%",title:g,textColor:"text-purple-500",className:"bg-purple-100",titleBgColor:"bg-purple-100",showCloseBtn:!0,shouldShow:!0,shouldClose:!0,children:[e.jsx("div",{className:"relative flex flex-col flex-wrap overflow-auto",children:e.jsx("div",{className:"pt-4",children:e.jsx("div",{children:l})})}),e.jsx(de,{onClick:Y,children:"Select"})]})})]})},Ce=({isChecked:g,onChange:l,disabled:b})=>e.jsx("div",{onClick:l,className:S("relative h-4 w-10 rounded-full px-4 transition duration-200 ease-in",{"bg-black-200 opacity-100":!g,"bg-[#FFE5FB] opacity-100":g,"cursor-not-allowed":b}),children:e.jsx("input",{type:"checkbox",id:"toggle",disabled:b,checked:g,onChange:l,className:S("checkbox_slide absolute left-[0px] top-1/2 h-5 w-5 -translate-y-1/2 transform cursor-pointer appearance-none rounded-full outline-none transition-transform duration-200 checked:translate-x-5 focus:outline-none",{"bg-white-100":!g,"bg-[#62096C]":g,"!cursor-not-allowed":b})})}),D=({label:g,classnames:l,children:b,heading:i})=>e.jsxs("div",{className:l,children:[e.jsxs("div",{className:"flex  items-center",children:[b," ",e.jsx("h5",{className:"fw-500 text-md ml-5",children:i})]}),g&&e.jsx("label",{className:"gray_color text-md mt-5 block text-left",children:g})]}),q=({config:g=[],formik:l,handleChange:b})=>{var Y;const[i,E]=I.useState([]),[P,O]=I.useState([]),[z,y]=I.useState([]);I.useEffect(()=>{var s,n,a,o;(s=l.initialValues)!=null&&s.initialFormValues&&(E((n=l.initialValues)==null?void 0:n.initialFormValues.filter(h=>h.type.name==k.MultipleSelect)),O((a=l.initialValues)==null?void 0:a.initialFormValues.filter(h=>h.type.name==k.SingleSelect)),y((o=l.initialValues)==null?void 0:o.initialFormValues.filter(h=>h.type.name==k.NumberMultipleNumberAnswer)))},[(Y=l.initialValues)==null?void 0:Y.initialFormValues]);const R=(s,n)=>{const{id:a,checked:o}=s.target;A(E,a,o,n)},X=(s,n)=>{const{id:a,checked:o}=s.target;A(O,a,o,n)},A=(s,n,a,o)=>{var v;s(f=>f.map(d=>{if(`${d.id}`===o.field){const p=d.answers.map(N=>(o.type===k.SingleSelect&&(N.isSelected=!1),`${N.id}`===n?{...N,isSelected:a}:N));return{...d,answers:p}}return d}));const h=(v=l.initialValues)==null?void 0:v.initialFormValues.map(f=>{if(`${f.id}`===o.field){const d=f.answers.map(p=>`${p.id}`===n?{...p,isSelected:a}:p);return{...f,answers:d}}return f});l.values.initialFormValues=h},K=(s,n)=>{let a=s.target.value;parseFloat(a)<n&&(a=n.toString()),a=a.replace("+","").replace("-",""),l.setFieldValue(s.target.name,a),b(s)},T=(s,n)=>{var o;y(h=>h.map(v=>{const f=v.answers.map(d=>{if(d.id==parseInt(s.field)){const p=parseInt(d.userInput||"0")+n;return{...d,userInput:p.toString()}}return d});return{...v,answers:f}}));const a=(o=l.initialValues)==null?void 0:o.initialFormValues.map(h=>{const v=h.answers.map(f=>{if(f.id==parseInt(s.field)){const d=parseInt(f.userInput||"0")+n;return{...f,userInput:d.toString()}}return f});return{...h,answers:v}});l.values.initialFormValues=a},u=s=>{const n=!l.values[s];l.setFieldValue(s,n),b({target:{name:s,value:n}})},V=(s,n,a)=>{var d;const o=s.target.value,h=s.target.id,v=p=>p.map(N=>{if(`${N.id}`===n.field){const B=N.answers.map(t=>`${t.id}`==h?{...t,userInput:o}:t);return{...N,answers:B}}return N});a==="checkbox"?E(p=>v(p)):a==="radio"&&O(p=>v(p));const f=(d=l.initialValues)==null?void 0:d.initialFormValues.map(p=>{if(`${p.id}`===n.field){const N=p.answers.map(B=>`${B.id}`==h?{...B,userInput:o}:B);return{...p,answers:N}}return p});l.values.initialFormValues=f},L=s=>{switch(s.toString()){case"1":case"2":case"3":case"5":case"10":return"Membership";case"7":case"8":case"9":case"12":return"Use Credits";default:return"default"}},W=s=>{var p,N,B;const{type:n,field:a,label:o,classnames:h,inputClassnames:v,limit:f}=s,d=L(a);switch(n){case F.POSITIVE_NUMBER:return e.jsx(D,{label:o,classnames:h,children:e.jsxs("div",{className:"rewards membership_input relative flex items-center",children:[e.jsx("span",{className:"fw-500 gray_color text-base",children:"$"}),e.jsx("input",{type:"number",value:l.values[a],name:a,min:0,step:"1",className:S(v,"fw-500  gray_color text-end"),onChange:t=>K(t,0)})]})},a);case F.BOOLEAN:return e.jsx(D,{label:o,heading:d,classnames:h,children:e.jsx(Ce,{isChecked:l.values[a]||!1,onChange:()=>u(a)},a)},a);case F.TEXT:return e.jsx(D,{label:o,children:e.jsx("input",{type:"text",name:a,value:l.values[a]||"",onChange:b})},a);case F.NUMBER:return e.jsx(D,{label:o,classnames:h,children:e.jsx("input",{type:"number",name:a,min:1,value:l.values[a]||"",className:v,onChange:t=>K(t,1)})},a);case F.ARRAY:return e.jsx(q,{config:s.children||[],formik:l,handleChange:b},a);case k.MultipleSelect:return e.jsx(U,{title:o,children:e.jsx("div",{children:(p=s.children)==null?void 0:p.map(t=>{const M=parseInt(s.field),r=parseInt(t.field),c=i.some(x=>x.id===M&&x.answers.some(j=>j.id===r&&j.isSelected)),w=i.find(x=>x.id===M),C=f&&w&&(w==null?void 0:w.answers.filter(x=>x.isSelected).length)>=f&&!c;return e.jsxs("div",{className:"flex flex-row items-center pb-2",children:[e.jsx(pe,{label:t.label,isChecked:c,isDisabled:!!C,labelClassnames:"text-sm whitespace-nowrap",onChange:x=>R(x,s),id:t.field}),t.isFreeText&&e.jsx("input",{id:t.field,onChange:x=>V(x,s,"checkbox"),maxLength:50,value:i.filter(x=>x.id===M).flatMap(x=>{var j;return((j=x.answers.find(H=>H.id===r&&H.userInput))==null?void 0:j.userInput)||""}),type:"text",className:"ml-5 w-full border-b-2 border-black-100 text-sm outline-none transition-colors duration-300 focus:border-purple-500"})]},t.label)})})},a);case k.SingleSelect:return e.jsx(U,{title:o,children:e.jsx("div",{children:(N=s.children)==null?void 0:N.map((t,M)=>e.jsxs("li",{className:"list-none",children:[t.isFreeText&&e.jsxs("div",{className:"flex flex-row items-center whitespace-nowrap pb-2 text-sm",children:[e.jsx($,{name:t.field,id:t.field,value:t.field,selectedValue:P.some(r=>r.id==parseInt(s.field)&&r.answers.some(c=>c.id==parseInt(t.field)&&c.isSelected))?t.field:void 0,onChange:r=>X(r,s),children:t.label},M),e.jsx("input",{maxLength:50,id:t.field,onChange:r=>V(r,s,"radio"),value:P.filter(r=>r.id===parseInt(s.field)).flatMap(r=>{var c;return((c=r.answers.find(w=>w.id===parseInt(t.field)&&w.userInput))==null?void 0:c.userInput)??""}),type:"text",className:"ml-5 w-full border-b-2 border-black-100 text-sm outline-none transition-colors duration-300 focus:border-purple-500"})]}),!t.isFreeText&&e.jsx("div",{className:"flex items-start justify-between py-2 text-sm",children:e.jsx($,{name:t.field,id:t.field,value:t.field,selectedValue:P.some(r=>r.id==parseInt(s.field)&&r.answers.some(c=>c.id==parseInt(t.field)&&c.isSelected))?t.field:void 0,onChange:r=>X(r,s),children:t.label},M)},M)]},t.field))})},a);case k.NumberMultipleNumberAnswer:return e.jsx(U,{title:o,children:e.jsx("div",{children:(B=s.children)==null?void 0:B.map(t=>{const r=(w=>z.reduce((C,x)=>{const j=x.answers.find(H=>H.id===parseInt(w.field));return C+parseInt((j==null?void 0:j.userInput)??"0")},0))(t),c=r===0;return e.jsxs("li",{className:"flex items-start justify-between py-2 text-sm",children:[e.jsx("span",{children:t.label}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(ue,{onClick:()=>T(t,-1),"aria-disabled":c,"data-testid":"minus",className:S("flex h-6 w-6 select-none items-center space-x-2 rounded-full border border-green-500 p-1 text-green-500 transition-colors",{"pointer-events-none cursor-not-allowed opacity-50":c},{"hover:cursor-pointer hover:bg-white-200":!c})}),e.jsx("span",{className:"text-sm text-green-500",children:r}),e.jsx(me,{onClick:()=>T(t,1),"data-testid":"plus",className:"flex h-6 w-6 select-none items-center space-x-2 rounded-full border border-green-500 p-1 text-green-500 transition-colors hover:cursor-pointer hover:bg-white-200"})]})]},t.label)})})},o)}};return e.jsx(e.Fragment,{children:g.map(W)})},Ie="data:image/png;base64,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",Se="/assets/kroger-D4zJgyWh.png",Ee="/assets/target-DlTRWuj0.svg",Be="/assets/walmart-CHTiyYF4.svg",Me=()=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:Ie,className:"target-logo my-0 w-7",alt:"Target"}),e.jsx("span",{className:"fw-500 sm:text-md ml-3 text-xl md:text-2xl",children:"Amazon"})]}),Fe=()=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:Be,className:"target-logo my-0",alt:"Target"}),e.jsx("span",{className:"fw-500 sm:text-md ml-3 text-xl md:text-2xl",children:"Walmart"})]}),Ve=()=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:Se,className:"target-logo my-0 w-6",alt:"Target"}),e.jsx("span",{className:"fw-500 sm:text-md ml-3 text-xl md:text-2xl",children:"Kroger"})]}),ze=()=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:Ee,className:"target-logo my-0",alt:"Target"}),e.jsx("span",{className:"fw-500 sm:text-md ml-3 text-xl md:text-2xl",children:"Target"})]}),_=I.memo(({store:g})=>{switch(g){case"AmazonAffiliateApi":case"Amazon":case"amazon":case"RainforestApi":return e.jsx(Me,{});case"WalmartAffiliateApi":case"Walmart":case"walmart":return e.jsx(Fe,{});case"KrogerApi":case"Kroger":case"kroger":return e.jsx(Ve,{});case"Target":case"target":return e.jsx(ze,{})}});_.displayName="MembershipLogo";function Re(g){return g.map(l=>({storeId:l.store.id,configuration:Te(l.fields)}))}function Te(g){const l={};return g.forEach(b=>{b.id&&b.value!==null&&(l[b.id]=b.value)}),l}const Le=({displayType:g=Q.collapsable,automaticallyUpdate:l,onSubmit:b,isSidePanel:i,jobConfigData:E,isStarting:P,closePanel:O})=>{const{carts:z,refetchCarts:y}=xe(),{setCurrentConfig:R,setStatus:X,isPending:A,status:K}=ge(),{refetch:T,data:u,isFetching:V}=Ae(),{mutateAsync:L}=je(),W=te("(max-width: 639px)"),[Y,s]=I.useState({}),[n,a]=I.useState([]),[o,h]=I.useState(!1),[v,f]=I.useState(E??{}),d=he(n,500),p=r=>{const c={};return r.forEach(w=>{w.fields.forEach(C=>{c[C.id.toString()]=C.fieldType===F.BOOLEAN?C.value==="true":C.value||"0"})}),c};I.useEffect(()=>{(u!=null&&u.data||E)&&f(p(E??u.data))},[u,f,E]),I.useEffect(()=>(d&&d.length>0&&l&&L({storeConfig:d}).then(()=>{}).catch(()=>{}),R({storeConfig:d}),()=>{R({storeConfig:[]})}),[d,L,l,R]);const N=r=>{s(c=>({...c,[r]:!c[r]}))},B=()=>{L({storeConfig:d}).then(()=>{y(),i||Z("Membership settings saved","success",1)}).catch(()=>{i||Z("Failed to save membership settings. Try again","error",1)})},t=r=>{switch(r.fieldType){case F.BOOLEAN:return{type:F.BOOLEAN,field:r.id.toString(),toggleState:Y[r.id]||r.value,handleToggle:N,label:r.displayText,classnames:"mb-10  flex-row text-base w-9/12 sm:w-full"};case F.POSITIVE_NUMBER:return{type:F.POSITIVE_NUMBER,field:r.id.toString(),label:r.displayText,classnames:"mb-10 flex-row justify-between text-base items-center text-base gary_color",inputClassnames:"flex flex-row rounded-md border border-black-100 text-base max-w-[5rem] text-base gary_color"};default:return null}};if(!u)return e.jsx("div",{className:"m-28",children:e.jsx(ee,{size:45})});const M=r=>{const c=u==null?void 0:u.data.map(w=>{const C={};return w.fields.forEach(x=>{const j=r[x.id.toString()];j!==void 0&&(C[x.id.toString()]=j.toString()),!j&&typeof j=="string"&&(C[x.id.toString()]="0")}),{storeId:w.store.id,configuration:C}});a(c)};return e.jsx(fe,{enableReinitialize:!0,initialValues:v,onSubmit:B,initialTouched:!0,children:r=>{const{handleChange:c,values:w,setValues:C,setFieldValue:x}=r,j=m=>{c(m),M({...w,[m.target.name]:m.target.value??"0"})},H=async()=>{h(!0);try{const m=await T();if(m.data){C(p(m==null?void 0:m.data.data));const G=Re(m.data.data);R({storeConfig:G??[]})}}catch{Z("Something went wrong. Please try again","error",3)}finally{h(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(be,{loading:P}),V?e.jsx("div",{className:"m-28",children:e.jsx(ee,{size:45})}):e.jsxs(we,{onSubmit:m=>{m.preventDefault(),b?b({storeConfig:d}):B()},className:S({"flex flex-col sm:pb-5":!i,"relative flex h-full w-full flex-col sm:p-5":i}),children:[i&&e.jsxs("div",{className:"mb-5",children:[e.jsx(J,{variant:"outline",colorTheme:"purple",className:"w-fit self-end text-sm",onClick:()=>void H(),disabled:o,children:"Reset Membership Information"}),e.jsx("p",{className:"mt-2 text-sm font-medium",children:"Personalize your savings by updating your membership information in each of the below stores."})]}),!V&&{[Q.collapsable]:e.jsx("div",{className:"flex flex-col overflow-auto",children:u==null?void 0:u.data.map(m=>e.jsx(ye,{className:S("mb-5 bg-white-100",i&&"border-opacity-50 bg-purple-500 font-thin"),title:e.jsx("div",{className:"w-35",children:e.jsx(_,{store:m.store.name},m.store.id)},m.store.id),content:e.jsx("div",{className:"max-w-full",children:e.jsx(q,{config:m.fields.map((G,ae)=>{if(ae===0){const{displayText:We,...re}=G;return t(re)}return t(G)}).filter(G=>G!==null),handleChange:j,formik:{handleChange:c,values:w,setFieldValue:x}})},m.store.id)},m.store.id))}),[Q.vertical]:e.jsx(e.Fragment,{children:u==null?void 0:u.data.map(m=>e.jsxs("div",{className:"w-35",children:[e.jsx(_,{store:m.store.name},m.store.id),e.jsx("div",{className:"max-w-lg ",children:e.jsx(q,{config:m.fields.map(t).filter(G=>G!==null),handleChange:j,formik:{handleChange:c,values:w,setFieldValue:x}})},m.store.id)]},m.store.id))})}[g],e.jsx("div",{className:S({"flex flex-col justify-center":!W,"mb-1 flex w-full flex-row justify-center":W}),children:(W||!i)&&e.jsxs("div",{className:S({"flex w-2/12 flex-col items-end self-end":!i,"flex w-full flex-col items-center self-center":W}),children:[!i&&e.jsx(J,{className:"my-5 w-full px-10",variant:"filled",colorTheme:"purple",type:"submit",children:"Save"}),i&&e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"my-5 w-min px-10 sm:w-full",variant:"filled",colorTheme:"purple",type:"submit",disabled:z.length<1||A,"aria-disabled":z.length<1||A,children:"Calculate"}),e.jsx(J,{colorTheme:"purple",variant:"outline",className:"w-full whitespace-nowrap px-10",onClick:O,children:"Back To Cart"}),z.length<1&&e.jsx("p",{className:"text-sm text-purple-500",children:"To activate smart saving, you must have at least one cart."})]}),K==se.success&&i&&e.jsx("a",{className:"mb-5 text-sm text-purple-500 hover:cursor-pointer hover:underline",onClick:()=>{X(se.toggled)},children:"Back to suggestions"})]})})]})]})}})};export{Le as S};
